import{B as q,C as B,r as g,o as N,a as S,E as f,G as b,H as n,I as e,f as l,K as o,J as s,L as w,M as P,N as V,aj as A,F as I,ak as x}from"./index.b0846524.js";import{a as i,Q as k}from"./QCard.783d5ef5.js";import{Q as L}from"./QInnerLoading.cc8f00d1.js";import{c as F,Q as R}from"./QForm.e008005b.js";import{Q as T}from"./QPage.22761661.js";import{u as $,d as j,e as E}from"./index.17631ce7.js";import{u as G}from"./store.ee215695.js";import{u as H}from"./vue-i18n.runtime.esm-bundler.3cfb172c.js";import"./use-dark.2c6a9be7.js";import"./use-transition.401a05f6.js";import"./axios.7331a07d.js";const M={class:"row"},U={class:"row justify-between items-center"},z={class:"text-h6 text-weight-bold"},J={class:"text-weight-bold q-mr-sm"},K={class:"text-weight-bold q-mr-sm"},O={class:"text-weight-bold q-mr-sm"},W={class:"text-weight-bold q-mr-sm"},X={class:"text-weight-bold q-mr-sm"},Y={key:0,class:"loader-block relative-position"},Z={class:"row"},me=q({__name:"ResultsPage",props:{isDesktop:{type:Boolean}},setup(ee){const v=$(),h=G(),y=B(),{t}=H(),_=t("shared.noData"),a=g({id:0,phone:"",firstname:"",lastname:"",surname:"",address:"",photo:"",email:"",vk:"",createdAt:0}),m=g(""),c=g([]),p=g(),C=()=>{const{firstname:u,lastname:d}=a.value;return!u.length&&!d.length},D=async()=>{try{p.value=!0;const u=await E({personId:a.value.id,text:m.value,createdAt:new Date().getTime()});c.value.push(u),m.value="",v.notify({type:"positive",message:t("resultsPage.success"),actions:[{icon:"close",color:"white",round:!0}]})}catch{v.notify({type:"negative",message:t("resultsPage.failedAddComment"),actions:[{icon:"close",color:"white",round:!0}]})}finally{p.value=!1}},Q=async()=>{try{c.value=await j(a.value.id)}catch{v.notify({type:"negative",message:t("resultsPage.failedGetComments"),actions:[{icon:"close",color:"white",round:!0}]})}};return N(async()=>{if(!h.foundPersonData.id)return y.push("/");a.value=h.foundPersonData,await Q()}),S(()=>{h.foundPersonData={}}),(u,d)=>(f(),b(T,null,{default:n(()=>[e("div",M,[l(k,{flat:"",class:"q-mt-md col-12 col-md-4 offset-md-4"},{default:n(()=>[l(i,null,{default:n(()=>[e("div",U,[e("div",z,o(s(t)("resultsPage.title")),1),l(w,{outline:"",icon:"chevron_left","no-caps":"",label:u.isDesktop?s(t)("shared.toSearchBtn"):"",round:!u.isDesktop,color:"secondary",onClick:d[0]||(d[0]=()=>s(y).push("/"))},null,8,["label","round"])])]),_:1}),l(i,{class:"text-grey-9"},{default:n(()=>[e("p",null,[e("span",J,o(s(t)("resultsPage.name"))+":",1),e("span",null,o(`${a.value.lastname} ${a.value.firstname} ${a.value.surname}`),1)]),e("p",null,[e("span",K,o(s(t)("resultsPage.phone"))+":",1),e("span",null,o(C()?s(_):a.value.phone),1)]),e("p",null,[e("span",O,o(s(t)("resultsPage.vk"))+":",1),e("span",null,o(a.value.vk.length?a.value.vk:s(_)),1)]),e("p",null,[e("span",W,o(s(t)("resultsPage.address"))+":",1),e("span",null,o(a.value.address.length?a.value.address:s(_)),1)]),e("p",null,[e("span",X,o(s(t)("resultsPage.createdAt"))+":",1),e("span",null,o(new Date(Number(a.value.createdAt)).toLocaleDateString()),1)])]),_:1}),l(i,{class:"q-gutter-md"},{default:n(()=>[c.value.length?V("",!0):(f(),P("div",Y,[l(L,{showing:!c.value.length,color:"secondary"},null,8,["showing"])])),(f(!0),P(I,null,A(c.value,r=>(f(),b(k,{key:r.id,flat:"",bordered:""},{default:n(()=>[l(i,{class:"row justify-end text-grey-8 text-caption"},{default:n(()=>[x(o(new Date(Number(r.createdAt)).toLocaleDateString()),1)]),_:2},1024),l(i,{class:"text-body2"},{default:n(()=>[x(o(r.text),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),l(i,null,{default:n(()=>[l(F,{onSubmit:D,class:"q-gutter-md q-mb-md"},{default:n(()=>[l(R,{outlined:"",modelValue:m.value,"onUpdate:modelValue":d[1]||(d[1]=r=>m.value=r),type:"textarea","lazy-rules":"",label:s(t)("shared.commentLabel"),disable:p.value,rules:[r=>r&&r.length>0||s(t)("shared.commentHint")]},null,8,["modelValue","label","disable","rules"]),e("div",Z,[l(w,{type:"submit",label:s(t)("resultsPage.addCommentBtn"),"no-caps":"",unelevated:"",color:"primary",loading:p.value,class:"col-12 col-md-4 offset-md-8"},null,8,["label","loading"])])]),_:1})]),_:1})]),_:1})])]),_:1}))}});export{me as default};
